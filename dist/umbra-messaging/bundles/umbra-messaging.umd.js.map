{"version":3,"file":"umbra-messaging.umd.js","sources":["ng://umbra-messaging/lib/shared/classes/toast-ref.ts","ng://umbra-messaging/lib/shared/classes/toast-config.ts","ng://umbra-messaging/lib/shared/animations/toast-fade.animation.ts","ng://umbra-messaging/lib/umbra-toast/umbra-toast.component.ts","ng://umbra-messaging/lib/shared/services/umbra-toast.service.ts","ng://umbra-messaging/lib/umbra-toast/umbra-toast.module.ts","ng://umbra-messaging/lib/shared/interfaces/toast-config.interface.ts"],"sourcesContent":["import { OverlayRef } from '@angular/cdk/overlay';\n\nexport class ToastRef {\n    constructor(private readonly overlay: OverlayRef) { }\n\n    close() {\n        this.overlay.dispose();\n    }\n\n    isVisible() {\n        return this.overlay && this.overlay.overlayElement;\n    }\n\n    getPosition() {\n        return this.overlay.overlayElement.getBoundingClientRect();\n    }\n}\n","import { InjectionToken, TemplateRef } from '@angular/core';\nimport { ToastConfigInterface } from '../interfaces/toast-config.interface';\nimport { ToastType } from '../types/toast.type';\n\nexport class ToastData {\n    type: ToastType;\n    text?: string;\n    template?: TemplateRef<any>;\n    templateContext?: {};\n}\n\nexport const defaultToastConfig: ToastConfigInterface = {\n    position: {\n        top: 20,\n        right: 20,\n    },\n    animation: {\n        fadeOut: 2500,\n        fadeIn: 300,\n    },\n};\n\nexport const TOAST_CONFIG_TOKEN = new InjectionToken<ToastConfigInterface>('toast-config');\n","import {\n    AnimationTriggerMetadata,\n    trigger,\n    state,\n    transition,\n    style,\n    animate,\n} from '@angular/animations';\n\nexport const toastAnimations: {\n    readonly fadeToast: AnimationTriggerMetadata;\n} = {\n    fadeToast: trigger('fadeAnimation', [\n        state('default', style({ opacity: 1 })),\n        transition('void => *', [style({ opacity: 0 }), animate('{{ fadeIn }}ms')]),\n        transition(\n            'default => closing',\n            animate('{{ fadeOut }}ms', style({ opacity: 0 })),\n        ),\n    ]),\n};\n\nexport type ToastAnimationState = 'default' | 'closing';\n","import {\n  Component,\n  OnInit,\n  ChangeDetectionStrategy,\n  Inject,\n  OnDestroy\n} from '@angular/core';\nimport {\n  TOAST_CONFIG_TOKEN,\n  ToastData\n} from '../shared/classes/toast-config';\nimport { ToastRef } from '../shared/classes/toast-ref';\nimport { ToastConfigInterface } from '../shared/interfaces/toast-config.interface';\nimport {\n  toastAnimations,\n  ToastAnimationState\n} from '../shared/animations/toast-fade.animation';\nimport { AnimationEvent } from '@angular/animations';\n\n@Component({\n  selector: 'umbra-messaging-toast',\n  templateUrl: './umbra-toast.component.html',\n  styleUrls: ['./umbra-toast.component.css'],\n  animations: [toastAnimations.fadeToast],\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class UmbraToastComponent implements OnInit, OnDestroy {\n  animationState: ToastAnimationState = 'default';\n  iconType: string;\n\n  private intervalId: number;\n\n  constructor(\n      readonly data: ToastData,\n      readonly ref: ToastRef\n  ) {\n    this.iconType = data.type === 'success' ? 'done' : data.type;\n  }\n\n  ngOnInit() {\n    this.intervalId = setTimeout(() => this.animationState = 'closing', 5000);\n  }\n\n  ngOnDestroy() {\n    clearTimeout(this.intervalId);\n  }\n\n  close() {\n    this.ref.close();\n  }\n\n  onFadeFinished(event: AnimationEvent) {\n    const { toState } = event;\n    const isFadeOut = (toState as ToastAnimationState) === 'closing';\n    const itFinished = this.animationState === 'closing';\n\n    if (isFadeOut && itFinished) {\n      this.close();\n    }\n  }\n}\n","import {\n  Inject,\n  Injectable,\n  Injector\n} from '@angular/core';\nimport { Overlay } from '@angular/cdk/overlay';\nimport {\n  ComponentPortal,\n  PortalInjector\n} from '@angular/cdk/portal';\nimport { ToastRef } from '../classes/toast-ref';\nimport {\n  defaultToastConfig,\n  TOAST_CONFIG_TOKEN,\n  ToastData\n} from '../classes/toast-config';\nimport { ToastConfigInterface } from '../interfaces/toast-config.interface';\nimport { UmbraToastComponent } from '../../umbra-toast/umbra-toast.component';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class UmbraToastService {\n  private lastToast: ToastRef;\n  private toastConfig: ToastConfigInterface;\n\n  constructor(\n      private overlay: Overlay,\n      private parentInjector: Injector\n  ) {}\n\n  showToast(toastData: ToastData, toastConfig?: ToastConfigInterface) {\n    if (toastConfig === null || toastConfig === undefined) {\n      this.toastConfig = defaultToastConfig;\n    }\n\n    const positionStrategy = this.getPositionStrategy();\n    const overlayRef = this.overlay.create({ positionStrategy });\n\n    const toastRef = new ToastRef(overlayRef);\n\n    const injector = this.getInjector(toastData, toastRef, this.parentInjector);\n    const toastPortal = new ComponentPortal(UmbraToastComponent, null, injector);\n\n    overlayRef.attach(toastPortal);\n\n    return toastRef;\n  }\n\n  getPositionStrategy() {\n    return this.overlay.position()\n        .global()\n        .top(this.getPosition())\n        .right(this.toastConfig.position.right + 'px');\n  }\n\n  getPosition() {\n    const lastToastIsVisible = this.lastToast && this.lastToast.isVisible();\n    const position = lastToastIsVisible\n        ? this.lastToast.getPosition().bottom\n        : this.toastConfig.position.top;\n\n    return position + 'px';\n  }\n\n  getInjector(data: ToastData, toastRef: ToastRef, parentInjector: Injector) {\n    const tokens = new WeakMap();\n\n    tokens.set(ToastData, data);\n    tokens.set(ToastRef, toastRef);\n\n    return new PortalInjector(parentInjector, tokens);\n  }\n}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { UmbraToastComponent } from './umbra-toast.component';\nimport { OverlayModule } from '@angular/cdk/overlay';\nimport { MatIconModule } from '@angular/material';\n\n@NgModule({\n    declarations: [ UmbraToastComponent ],\n    imports: [\n        CommonModule,\n        OverlayModule,\n        MatIconModule\n    ],\n    entryComponents: [ UmbraToastComponent ]\n})\nexport class UmbraToastModule {}\n","export interface ToastConfigInterface {\n    position?: {\n        top: number;\n        right: number;\n    };\n    animation?: {\n        fadeOut: number;\n        fadeIn: number;\n    };\n}\n"],"names":["InjectionToken","trigger","state","style","transition","animate","Component","ChangeDetectionStrategy","ComponentPortal","PortalInjector","Injectable","Overlay","Injector","NgModule","CommonModule","OverlayModule","MatIconModule"],"mappings":"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"}